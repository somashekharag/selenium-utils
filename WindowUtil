package com.itaf.ui.utils;

import com.itaf.core.driver.ITAFDriverFactory;
import org.openqa.selenium.WebDriver;

import java.util.Set;

/**
 * Utilities for window/tab handling.
 * Use switchToWindow when a new window opens and you want to focus it.
 */
public final class WindowUtil {

    private WindowUtil() {}

    /**
     * Switch to the first window whose title contains the provided string.
     * If not found, switches back to the original window.
     */
    public static void switchToWindow(String windowTitle) {
        WebDriver driver = ITAFDriverFactory.getDriver();
        String current = driver.getWindowHandle();
        for (String handle : driver.getWindowHandles()) {
            driver.switchTo().window(handle);
            if (driver.getTitle().contains(windowTitle)) {
                return;
            }
        }
        // fallback: restore original
        driver.switchTo().window(current);
    }

    /**
     * Switch to the last opened window (useful after clicking something that opens a new tab).
     */
    public static void switchToLastWindow() {
        WebDriver driver = ITAFDriverFactory.getDriver();
        Set<String> windows = driver.getWindowHandles();
        driver.switchTo().window(windows.toArray(new String[0])[windows.size() - 1]);
    }
}
